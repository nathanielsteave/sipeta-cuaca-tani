---
import Layout from '../layouts/Layout.astro';
import PanduanPetani from '../components/weather/PanduanPetani.jsx';
import Accordion from '../components/ui/Accordion.astro';
import { getWeatherForBagorKulon, type WeatherData } from '../services/bmkg.ts';

const weatherData: WeatherData | null = await getWeatherForBagorKulon();
---

<Layout title="Pusat Pengetahuan - SiPETA Cuaca Tani">
  <div class="max-w-4xl mx-auto p-4 sm:p-6 space-y-8">
    <header class="fade-in text-center">
      {/* --- PERUBAHAN DI SINI --- */}
      <h1 class="text-4xl font-extrabold text-black">Pusat Pengetahuan Petani</h1>
      <p class="text-neutral-600 dark:text-neutral-400 mt-2">Panduan lengkap dari persiapan lahan hingga pasca-panen.</p>
    </header>

    <main class="space-y-12">
      <section class="fade-in" style="animation-delay: 100ms;">
        {/* --- PERUBAHAN DI SINI --- */}
        <h2 class="text-2xl font-bold mb-4 text-center text-black">💡 Rekomendasi Cepat Hari Ini</h2>
        {weatherData ? (
          <PanduanPetani client:load weatherData={weatherData} />
        ) : (
          <div class="text-center py-10 bg-white dark:bg-neutral-800 rounded-2xl shadow-md">
            <p class="text-lg text-neutral-500 dark:text-neutral-300">Gagal memuat rekomendasi cuaca.</p>
          </div>
        )}
      </section>
      
      <section class="fade-in" style="animation-delay: 200ms;">
        {/* --- PERUBAHAN DI SINI --- */}
        <h2 class="text-2xl font-bold mb-4 text-center text-black">📚 Panduan Lengkap Pertanian</h2>
        <div class="space-y-4">
          
          {/* --- PERUBAHAN DI SINI --- */}
          <h3 class="font-bold text-xl text-black mt-6 border-b-2 border-primary-200 dark:border-primary-800 pb-2">A. Berdasarkan Fase Tanaman</h3>

          <Accordion title="Persiapan Lahan" icon="🚜">
            <p class="mb-2">Kunci dari fase ini adalah <strong class="text-secondary-700 dark:text-secondary-400">kondisi tanah yang tepat</strong>. Lakukan saat tanah tidak terlalu basah dan tidak ada prediksi hujan lebat.</p>
            <ul class="space-y-2">
              <li><strong>Pengolahan Tanah:</strong> Ideal dilakukan beberapa hari setelah hujan ringan. Hindari membajak saat tanah kering keras atau basah lengket.</li>
              <li><strong>Pembuatan Bedengan:</strong> Di musim hujan, buat bedengan lebih tinggi (±30 cm) untuk mencegah akar terendam air.</li>
              <li><strong>Pupuk Dasar:</strong> Berikan pupuk kandang/kompos 2-3 minggu sebelum tanam agar nutrisi sempat terurai dan menyatu dengan tanah.</li>
            </ul>
          </Accordion>
          
          <Accordion title="Penanaman & Pembibitan" icon="🌱">
            <p class="mb-2">Memilih <strong class="text-secondary-700 dark:text-secondary-400">momentum yang pas</strong> akan sangat menentukan keberhasilan tumbuh tanaman.</p>
            <ul class="space-y-2">
                <li><strong>Waktu Tanam Terbaik:</strong> Lakukan pada sore hari (setelah jam 15:00) untuk mengurangi stres tanaman akibat panas matahari.</li>
                <li><strong>Perhatikan Prediksi Cuaca:</strong> Jika menanam benih, pastikan ada prediksi hujan ringan dalam 1-2 hari ke depan untuk membantu perkecambahan.</li>
            </ul>
          </Accordion>

          <Accordion title="Perawatan & Pertumbuhan" icon="🌿">
            <p class="mb-2">Fase terpanjang yang membutuhkan <strong class="text-secondary-700 dark:text-secondary-400">perhatian rutin</strong> terhadap air, nutrisi, dan hama.</p>
            <ul class="space-y-2">
              <li><strong>Pengairan:</strong> Selalu cek kelembapan tanah. Penyiraman paling efektif dilakukan pada pagi atau sore hari.</li>
              <li><strong>Pemupukan Susulan:</strong> Jangan memupuk tepat sebelum hujan lebat. Waktu terbaik adalah saat tanah dalam kondisi lembab.</li>
              <li><strong>Pengendalian Hama:</strong> Semprotkan pestisida saat cuaca tenang (tidak berangin) dan tidak akan hujan dalam 4-6 jam kedepan agar efektif.</li>
            </ul>
          </Accordion>

            <Accordion title="Panen & Pasca-Panen" icon="🌾">
            <p class="mb-2">Cuaca saat panen dan setelahnya sangat <strong class="text-secondary-700 dark:text-secondary-400">menentukan kualitas</strong> hasil akhir.</p>
            <ul class="space-y-2">
              <li><strong>Waktu Panen:</strong> Usahakan panen pada hari yang cerah untuk mengurangi kadar air awal pada hasil panen.</li>
              <li><strong>Proses Pengeringan:</strong> Manfaatkan panas matahari secara maksimal. Selalu siapkan terpal atau penutup jika cuaca mendadak mendung.</li>
            </ul>
          </Accordion>

          {/* --- PERUBAHAN DI SINI --- */}
          <h3 class="font-bold text-xl text-black mt-8 border-b-2 border-primary-200 dark:border-primary-800 pb-2">B. Menghadapi Cuaca Ekstrem</h3>

            <Accordion title="Strategi Musim Kemarau" icon="🏜️">
              <ul class="space-y-2">
                <li><strong>Konservasi Air:</strong> Gunakan sistem irigasi tetes atau buat rorak (lubang resapan) untuk menampung sisa air hujan.</li>
                <li><strong>Gunakan Mulsa:</strong> Tutup permukaan tanah dengan jerami atau mulsa plastik untuk menekan penguapan.</li>
                <li><strong>Pilih Tanaman Tahan Kering:</strong> Pertimbangkan menanam sorgum, jagung, atau singkong.</li>
              </ul>
            </Accordion>

            <Accordion title="Strategi Musim Hujan" icon="🌧️">
              <ul class="space-y-2">
                <li><strong>Perkuat Drainase:</strong> Pastikan saluran pembuangan air di sekitar lahan tidak tersumbat dan lancar.</li>
                <li><strong>Pascabanjir:</strong> Setelah air surut, segera bersihkan lumpur yang menempel pada daun. Semprotkan fungisida untuk mencegah penyakit busuk akar.</li>
                <li><strong>Jarak Tanam:</strong> Beri jarak tanam yang sedikit lebih lebar untuk meningkatkan sirkulasi udara dan mengurangi kelembapan antar tanaman.</li>
              </ul>
            </Accordion>

        </div>
      </section>
    </main>
  </div>
</Layout>

<style>
/* Style tambahan untuk list agar lebih rapi */
.prose ul {
  padding-left: 1.25rem;
}
.prose ul > li::marker {
  color: var(--tw-prose-counters);
}
</style>